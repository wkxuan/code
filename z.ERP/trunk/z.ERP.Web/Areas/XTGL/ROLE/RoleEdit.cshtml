@using z.ERP.Web.Areas.Share.Render
@using z.ERP.Entities.Enum
@using z.ERP.Web.Areas.Layout.Edit;
@inherits EditViewBase<string>
@section head{
    <style>
    .zzc {
        width: 100%;
        height: 370px;
        position: absolute;
        background-color: #F3F3F3;
        z-index: 999999999;
        opacity: 0.6;
        margin-top: 0;
    }
</style>
    }
@section baseParam{
    <row>
        <i-col span="2" class="RowTitle">
            <span class="mustElement">*</span>
        角色代码
        </i-col>
        <i-col span="6" class="RowText">
            <i-input v-model="dataParam.ROLECODE" v-bind:disabled="!disabled" />
        </i-col>
        <i-col span="2" class="RowTitle">
            <span class="mustElement">*</span>
        角色名称
        </i-col>
        <i-col span="6" class="RowText">
            <i-input v-model="dataParam.ROLENAME" v-bind:disabled="!disabled" />
        </i-col>
    </row>
    <row>
        <i-col span="2" class="RowTitle">
            <span class="mustElement">*</span>
        所属机构
        </i-col>
        <i-col span="6" class="RowText">
            <yx-cascader v-bind:value.sync="dataParam.ORGIDCASCADER" method="GetTreeOrg" notlevellast
                         v-on:change="orgChange" v-bind:disabled="!disabled"></yx-cascader>
        </i-col>
        <i-col span="2" class="RowTitle">作废标记</i-col>
        <i-col span="6" class="RowText">
            @{
                RenderControl(new EnumCheckBoxListRender<标记>()
                {
                    vModel = "dataParam.VOID_FLAG",
                    MultiSelect = false
                });
            }
        </i-col>
    </row>
    }
@section detailParam{  
    <Tabs type="card" value="name1">
        <Tab-Pane label="菜单权限" name="name1">
            <yx-tree v-bind:data="screenParam.userModule"  v-bind:disablecheckbox="!disabled"  ref="moduleTreeRef"
                     v-bind:showcheckbox="true" v-bind:checkstrictly="true" v-on:oncheckchange="onCheckChangeModule"></yx-tree>
        </Tab-Pane>
        <Tab-Pane label="门店权限" name="name2">
            <div class="zzc" v-if="!disabled"></div>
            
            <i-table size="small" :border="true" height="370" width="400" ref="branchRef"
             v-bind:columns="screenParam.colDef_BRANCH" v-bind:data="screenParam.branch"></i-table>
        </Tab-Pane>
        <Tab-Pane label="区域楼层权限" name="name3">
            <yx-tree v-bind:data="screenParam.regionTreeData" v-bind:disablecheckbox="!disabled" ref="regionTreeRef"
                     v-bind:showcheckbox="true">
            </yx-tree>
        </Tab-Pane>
        <Tab-Pane label="业态权限" name="name4">
            <yx-tree v-bind:data="screenParam.ytTreeData" v-bind:disablecheckbox="!disabled"  ref="ytTreeRef"
                     v-bind:showcheckbox="true">
            </yx-tree>
        </Tab-Pane>
        <Tab-Pane label="预警权限" name="name5">
            <div class="zzc" v-if="!disabled"></div>
            <i-table size="small" :border="true" height="370" width="400" ref="alertRef"
                     v-bind:columns="screenParam.colDef_Alert" v-bind:data="screenParam.alert"></i-table>
        </Tab-Pane>
        <Tab-Pane label="费用项目" name="name6">
            <div class="zzc" v-if="!disabled"></div>
            <i-table size="small" :border="true" height="370" width="400" ref="feeRef"
                     v-bind:columns="screenParam.colDef_Menufee" v-bind:data="screenParam.fee"></i-table>
        </Tab-Pane>
        <Tab-Pane label="其他权限" name="name7">
            <row>
                <i-col span="12">
                    <i-button icon="md-settings" v-on:click="SelCrmRole" 
                              >CRM权限</i-button>
                </i-col>
            </row>
        </Tab-Pane>
    </Tabs>              
}

@section pops{
<yx-modal v-bind:src="screenParam.srcPopCrmRole" title="CRM权限" width="800" height="400"
          v-bind:modal-visible.sync="screenParam.showPopCrmRole"></yx-modal>
}
